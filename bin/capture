#!/usr/bin/env bash

# A script to start capturing video from Raspberry Pi camera and
# output it to stdout.

set -e

[ -n "${CAPTURE_PASSWORD}" ] && grep -q "${CAPTURE_PASSWORD}"

# First, print headers (if present)
echo -n "$*"
exec raspivid \
	--timeout 0 \
	--nopreview \
	--vstab \
	--width "${CAPTURE_WIDTH:-640}" \
	--height "${CAPTURE_HEIGHT:-480}" \
	--framerate "${CAPTURE_FPS:-25}" \
	--vflip --hflip \
	-o -
